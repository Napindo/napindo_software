"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("electron"),T=require("node:fs"),c=require("node:path"),Z=require("node:url"),w=require("node:fs/promises");var P=typeof document<"u"?document.currentScript:null;function ee(r){const t=new s.BrowserWindow({icon:c.join(r.publicDir,"assets","logo.png"),autoHideMenuBar:!0,webPreferences:{preload:r.preload,devTools:!1}});return t.setMenuBarVisibility(!1),t.webContents.on("did-finish-load",()=>{t.webContents.send("main-process-message",new Date().toLocaleString())}),t.webContents.on("did-fail-load",(e,n,a,o)=>{console.error("Renderer failed to load",{errorCode:n,errorDescription:a,validatedURL:o})}),r.devServerUrl?t.loadURL(r.devServerUrl):t.loadFile(c.join(r.rendererDist,"index.html")),t}const u=r=>(r==null?void 0:r.ok)===!0||(r==null?void 0:r.success)===!0,d=r=>{if(r){if(typeof r.data<"u")return r.data;if(typeof r.items<"u")return r.items;if(typeof r.rows<"u")return r.rows}},B=r=>Array.from(new Set(r.map(t=>t==null?"":String(t).trim()).filter(Boolean)));function $(r){if(!T.existsSync(r))return;const t=T.readFileSync(r,"utf-8");for(const e of t.split(`
`)){const n=e.trim();if(!n||n.startsWith("#"))continue;const[a,...o]=n.split("=");typeof process.env[a]>"u"&&(process.env[a]=o.join("=").trim())}}const R=process.env.APP_ROOT;R&&$(c.resolve(R,".env"));$(c.resolve(process.cwd(),".env"));$(c.resolve(process.cwd(),"..",".env"));const f=process.env.API_BASE_URL||"http://192.168.1.86:8133",m=process.env.API_PREFIX||"/api",te=()=>{const t=(process.env.NO_PROXY||process.env.no_proxy||"").split(",").map(a=>a.trim()).filter(Boolean),e=["192.168.1.86","127.0.0.1"];let n=!1;if(e.forEach(a=>{t.includes(a)||(t.push(a),n=!0)}),n){const a=t.join(",");process.env.NO_PROXY=a,process.env.no_proxy=a}};async function l(r,t={}){const e=`${f.replace(/\/$/,"")}${m}${r}`;te();const n=async a=>{const o=typeof t.timeoutMs=="number"?t.timeoutMs:0,i=o>0?new AbortController:null,y=i?setTimeout(()=>{i.abort()},o):null;try{const g=await fetch(a,{...t,headers:{"Content-Type":"application/json",...t.headers||{}},signal:i==null?void 0:i.signal});y&&clearTimeout(y);const S=g.headers.get("content-type")||"";let E;return S.includes("application/json")?E=await g.json():E={success:!1,ok:!1,message:await g.text()},{status:g.status,body:E}}finally{y&&clearTimeout(y)}};try{return await n(e)}catch(a){const o=a instanceof Error?a.message:String(a);if(a instanceof Error&&a.name==="AbortError")return{status:408,body:{success:!1,message:`Request timeout saat menghubungi API (${e}). Coba lagi atau cek koneksi API/DB.`}};if(e.includes("192.168.1.86")){const y=e.replace("192.168.1.86","127.0.0.1");try{return await n(y)}catch(g){const S=g instanceof Error?g.message:String(g);return{status:500,body:{success:!1,message:`Tidak dapat terhubung ke API (${e}). ${o}. Fallback ${y} gagal: ${S}`}}}}return{status:500,body:{success:!1,message:`Tidak dapat terhubung ke API (${e}). ${o}`}}}}async function re(){const{body:r}=await l("/health");if(!u(r))return{success:!1,message:r.message};const t=d(r);return{success:!0,serverTime:t==null?void 0:t.serverTime}}async function ae(r,t=10){const e=r.replace(/[^\w.]/g,""),n=new URLSearchParams({limit:String(t)}),{body:a}=await l(`/gabung/table-preview/${e}?${n.toString()}`);if(!u(a))throw new Error(a.message||"Gagal mengambil preview data");const o=d(a);return(o==null?void 0:o.rows)??o??[]}async function ne(r,t=200,e="exhibitor"){const n=new URLSearchParams({limit:String(t),person:e}),{body:a}=await l(`/gabung/segment/${encodeURIComponent(r)}?${n.toString()}`);if(!u(a))throw new Error(a.message||"Gagal mengambil data gabung");const o=d(a)??{};return o.items??o.rows??o??[]}async function oe(){const{body:r}=await l("/gabung/exhibitor-count");if(!u(r))throw new Error(r.message||"Gagal mengambil jumlah exhibitor per pameran");return d(r)}async function se(){const{body:r}=await l("/gabung/expo-chart");if(!u(r))throw new Error(r.message||"Gagal mengambil data grafik pameran");return d(r)}async function ce(r){var i;const t=(r==null?void 0:r.page)??1,e=(r==null?void 0:r.pageSize)??200,n=(i=r==null?void 0:r.q)==null?void 0:i.trim(),a=new URLSearchParams({page:String(t),pageSize:String(e)});n&&a.set("q",n);const{body:o}=await l(`/gabung?${a.toString()}`);if(!u(o))throw new Error(o.message||"Gagal memuat data gabung");return d(o)??o}async function ie(r){const t=r.trim(),e=encodeURIComponent(t),{body:n}=await l(`/gabung/company/${e}`);if(!u(n))throw new Error(n.message||"Gagal mencari perusahaan");const a=d(n)??{};return a.items??a.rows??a??[]}async function ue(r){const{body:t}=await l("/gabung",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal menyimpan data");return d(t)??t}async function le(r){const{body:t}=await l("/gabung/import/excel",{method:"POST",body:JSON.stringify(r),timeoutMs:7e3});if(!u(t))throw new Error(t.message||"Gagal mengimpor data Excel");return d(t)??t}async function de(r,t){const e=encodeURIComponent(String(r)),{body:n}=await l(`/gabung/${e}`,{method:"PUT",body:JSON.stringify(t)});if(!u(n))throw new Error(n.message||"Gagal memperbarui data");return d(n)??n}async function pe(r){const t=Array.from(new Set(r.map(n=>String(n).trim()).filter(Boolean))),e=[];for(const n of t){const a=encodeURIComponent(n),{body:o}=await l(`/gabung/${a}`,{method:"DELETE"}),i=u(o);if(e.push({id:n,success:i,message:o.message}),!i)throw new Error(o.message||`Gagal menghapus data ${n}`)}return e}async function fe(r){const{body:t}=await l("/report/labelvisitor",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat label visitor");return d(t)??t.data}async function me(r){const{body:t}=await l("/report/labelgover",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat label gover");return d(t)??t.data}async function he(r){const{body:t}=await l("/report/perusahaan",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat report perusahaan");return d(t)??t.data}async function ge(r){const{body:t}=await l("/report/government",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat report government");return d(t)??t.data}async function ye(r){const{body:t}=await l("/report/jumlah/perusahaan",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat report jumlah perusahaan");return d(t)??t.data}async function we(r){const{body:t}=await l("/report/jumlah/government",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat report jumlah government");return d(t)??t.data}async function xe(r){const{body:t}=await l("/report/businessvisitor",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal memuat business visitor");return d(t)??t.data}async function be(){const{body:r}=await l("/report/label/options");if(!u(r))throw new Error(r.message||"Gagal memuat opsi label");return d(r)??r.data}async function G(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelvisitor/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak label perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"print-label-perusahaan.pdf",buffer:a,base64:a.toString("base64")}}async function C(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelgover/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak label government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"print-label-government.pdf",buffer:a,base64:a.toString("base64")}}async function ve(r){const t=`${f.replace(/\/$/,"")}${m}/gabung/personal-pdf`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const g=await e.text();throw new Error(g||"Gagal mengunduh PDF")}const n=await e.arrayBuffer(),a=Buffer.from(n),o=e.headers.get("content-disposition")||"",i=/filename="?([^"]+)"?/i.exec(o),y=(i==null?void 0:i[1])||"database-personal.pdf";return{contentType:e.headers.get("content-type")||"application/pdf",filename:y,buffer:a,base64:a.toString("base64")}}async function D(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelvisitor/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"print-label-perusahaan.xlsx",buffer:a,base64:a.toString("base64")}}async function k(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelgover/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"print-label-government.xlsx",buffer:a,base64:a.toString("base64")}}async function J(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelvisitor/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"print-label-perusahaan.docx",buffer:a,base64:a.toString("base64")}}async function N(r){const t=`${f.replace(/\/$/,"")}${m}/report/labelgover/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"print-label-government.docx",buffer:a,base64:a.toString("base64")}}async function L(r){const t=`${f.replace(/\/$/,"")}${m}/report/perusahaan/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak report perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"report-perusahaan.pdf",buffer:a,base64:a.toString("base64")}}async function I(r){const t=`${f.replace(/\/$/,"")}${m}/report/government/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak report government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"report-government.pdf",buffer:a,base64:a.toString("base64")}}async function U(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/perusahaan/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak report jumlah perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"report-jumlah-perusahaan.pdf",buffer:a,base64:a.toString("base64")}}async function A(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/government/print`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mencetak report jumlah government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/pdf",filename:"report-jumlah-government.pdf",buffer:a,base64:a.toString("base64")}}async function W(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/perusahaan/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel report jumlah perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"report-jumlah-perusahaan.xlsx",buffer:a,base64:a.toString("base64")}}async function F(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/government/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel report jumlah government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"report-jumlah-government.xlsx",buffer:a,base64:a.toString("base64")}}async function V(r){const t=`${f.replace(/\/$/,"")}${m}/report/perusahaan/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel report perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"report-perusahaan.xlsx",buffer:a,base64:a.toString("base64")}}async function q(r){const t=`${f.replace(/\/$/,"")}${m}/report/government/export/excel`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Excel report government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",filename:"report-government.xlsx",buffer:a,base64:a.toString("base64")}}async function H(r){const t=`${f.replace(/\/$/,"")}${m}/report/perusahaan/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word report perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"report-perusahaan.docx",buffer:a,base64:a.toString("base64")}}async function X(r){const t=`${f.replace(/\/$/,"")}${m}/report/government/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word report government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"report-government.docx",buffer:a,base64:a.toString("base64")}}async function z(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/perusahaan/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word report jumlah perusahaan")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"report-jumlah-perusahaan.docx",buffer:a,base64:a.toString("base64")}}async function Y(r){const t=`${f.replace(/\/$/,"")}${m}/report/jumlah/government/export/word`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r||{})});if(!e.ok){const o=await e.text();throw new Error(o||"Gagal mengunduh Word report jumlah government")}const n=await e.arrayBuffer(),a=Buffer.from(n);return{contentType:e.headers.get("content-type")||"application/vnd.openxmlformats-officedocument.wordprocessingml.document",filename:"report-jumlah-government.docx",buffer:a,base64:a.toString("base64")}}const h=r=>({success:!1,message:r instanceof Error?r.message:String(r)});function Se(){s.ipcMain.handle("db:testConnection",async()=>{try{return{...await re()}}catch(r){return h(r)}}),s.ipcMain.handle("db:fetchTableData",async(r,t)=>{try{return{success:!0,rows:await ae(t)}}catch(e){return h(e)}}),s.ipcMain.handle("db:fetchExhibitors",async(r,t,e=200,n="exhibitor")=>{try{return{success:!0,rows:await ne(t,e,n)}}catch(a){return h(a)}}),s.ipcMain.handle("db:fetchExhibitorCountByExpo",async()=>{try{return{success:!0,data:await oe()}}catch(r){return h(r)}}),s.ipcMain.handle("db:fetchExpoChartData",async()=>{try{return{success:!0,data:await se()}}catch(r){return h(r)}}),s.ipcMain.handle("db:findCompany",async(r,t)=>{try{return{success:!0,rows:await ie(t)}}catch(e){return h(e)}}),s.ipcMain.handle("db:listGabung",async(r,t)=>{try{return{success:!0,data:await ce(t)}}catch(e){return h(e)}}),s.ipcMain.handle("db:saveAddData",async(r,t)=>{try{return{success:!0,data:await ue(t)}}catch(e){return h(e)}}),s.ipcMain.handle("db:importGabungExcel",async(r,t)=>{try{return{success:!0,data:await le(t)}}catch(e){return h(e)}}),s.ipcMain.handle("db:updateAddData",async(r,t,e)=>{try{return{success:!0,data:await de(t,e)}}catch(n){return h(n)}}),s.ipcMain.handle("db:deleteAddData",async(r,t)=>{try{return{success:!0,data:await pe(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:labelvisitor",async(r,t)=>{try{return{success:!0,data:await fe(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:labelgover",async(r,t)=>{try{return{success:!0,data:await me(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:perusahaan",async(r,t)=>{try{return{success:!0,data:await he(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:government",async(r,t)=>{try{return{success:!0,data:await ge(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:jumlah-perusahaan",async(r,t)=>{try{return{success:!0,data:await ye(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:jumlah-government",async(r,t)=>{try{return{success:!0,data:await we(t)}}catch(e){return h(e)}}),s.ipcMain.handle("report:labeloptions",async()=>{try{return{success:!0,data:await be()}}catch(r){return h(r)}}),s.ipcMain.handle("db:personalDatabasePdf",async(r,t)=>{try{return{success:!0,data:await ve(t)}}catch(e){return h(e)}})}async function Ee(r=200){const t=new URLSearchParams({limit:String(r)}),{body:e}=await l(`/audit/logs?${t.toString()}`);if(!u(e))throw new Error(e.message||"Gagal memuat audit log");return d(e)??[]}async function Pe(r){const{body:t}=await l("/audit/logs",{method:"POST",body:JSON.stringify(r??{})});if(!u(t))throw new Error(t.message||"Gagal menyimpan audit log");return d(t)??t}const K=r=>({success:!1,message:r instanceof Error?r.message:String(r)});function Te(){s.ipcMain.handle("db:fetchAuditLogs",async(r,t=200)=>{try{return{success:!0,rows:await Ee(Number(t)||200)}}catch(e){return K(e)}}),s.ipcMain.handle("db:createAuditLog",async(r,t)=>{try{return{success:!0,data:await Pe(t)}}catch(e){return K(e)}})}async function Me(r){const{body:t,status:e}=await l("/pengguna/login",{method:"POST",body:JSON.stringify(r)});if(!u(t)){if(e===401)return null;throw new Error(t.message||"Login gagal")}return d(t)}async function Oe(){const{body:r}=await l("/pengguna");if(!u(r))throw new Error(r.message||"Gagal memuat data pengguna");const t=d(r)??[],e=B(t.map(a=>a==null?void 0:a.username)),n=B(t.map(a=>a==null?void 0:a.division));return{usernames:e,divisions:n}}async function $e(r){const{body:t}=await l("/pengguna",{method:"POST",body:JSON.stringify(r)});if(!u(t))throw new Error(t.message||"Gagal membuat user");return d(t)}async function _e(){const{body:r}=await l("/pengguna");if(!u(r))throw new Error(r.message||"Gagal memuat daftar pengguna");return d(r)??[]}async function je(r){const t={username:r.username,password:r.currentPassword,division:r.division??null},e=await l("/pengguna/login",{method:"POST",body:JSON.stringify(t)});if(!u(e.body))throw e.status===401?new Error("Password saat ini salah."):new Error(e.body.message||"Gagal memverifikasi password.");const{body:n}=await l(`/pengguna/${encodeURIComponent(r.username)}`,{method:"PUT",body:JSON.stringify({password:r.newPassword,division:r.division??null})});if(!u(n))throw new Error(n.message||"Gagal memperbarui password.");return d(n)}async function Be(r){const{body:t}=await l(`/pengguna/${encodeURIComponent(r.username)}`,{method:"PUT",body:JSON.stringify({status:"OFF"})});if(!u(t))throw new Error(t.message||"Gagal logout user");return d(t)}const x=r=>({success:!1,message:r instanceof Error?r.message:String(r)});function Re(){s.ipcMain.handle("db:login",async(r,t)=>{try{const e=await Me(t);return e?{success:!0,user:e}:{success:!1,message:"Username, password, atau divisi tidak cocok."}}catch(e){return x(e)}}),s.ipcMain.handle("db:userHints",async()=>{try{return{success:!0,hints:await Oe()}}catch(r){return x(r)}}),s.ipcMain.handle("db:createPengguna",async(r,t)=>{try{return{success:!0,data:await $e(t),message:"User berhasil dibuat"}}catch(e){return x(e)}}),s.ipcMain.handle("db:changePenggunaPassword",async(r,t)=>{try{return{success:!0,data:await je(t),message:"Password berhasil diubah"}}catch(e){return x(e)}}),s.ipcMain.handle("db:logoutPengguna",async(r,t)=>{try{return{success:!0,data:await Be(t),message:"Logout berhasil"}}catch(e){return x(e)}}),s.ipcMain.handle("db:listPengguna",async()=>{try{return{success:!0,rows:await _e()}}catch(r){return x(r)}})}const p=r=>({success:!1,message:r instanceof Error?r.message:String(r)});function Ge(){s.ipcMain.handle("report:businessvisitor",async(r,t)=>{try{return{success:!0,data:await xe(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelvisitor:pdf",async(r,t)=>{try{return{success:!0,data:await G(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelvisitor:excel",async(r,t)=>{try{return{success:!0,data:await D(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelvisitor:word",async(r,t)=>{try{return{success:!0,data:await J(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelgover:pdf",async(r,t)=>{try{return{success:!0,data:await C(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelgover:excel",async(r,t)=>{try{return{success:!0,data:await k(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelgover:word",async(r,t)=>{try{return{success:!0,data:await N(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:perusahaan:pdf",async(r,t)=>{try{return{success:!0,data:await L(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:perusahaan:excel",async(r,t)=>{try{return{success:!0,data:await V(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:perusahaan:word",async(r,t)=>{try{return{success:!0,data:await H(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:government:pdf",async(r,t)=>{try{return{success:!0,data:await I(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:government:excel",async(r,t)=>{try{return{success:!0,data:await q(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:government:word",async(r,t)=>{try{return{success:!0,data:await X(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-perusahaan:pdf",async(r,t)=>{try{return{success:!0,data:await U(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-perusahaan:excel",async(r,t)=>{try{return{success:!0,data:await W(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-perusahaan:word",async(r,t)=>{try{return{success:!0,data:await z(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-government:pdf",async(r,t)=>{try{return{success:!0,data:await A(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-government:excel",async(r,t)=>{try{return{success:!0,data:await F(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-government:word",async(r,t)=>{try{return{success:!0,data:await Y(t)}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelvisitor:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Label Perusahaan",defaultPath:"print-label-perusahaan.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await D(t):a===".docx"||a===".doc"?o=await J(t):o=await G(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}}),s.ipcMain.handle("report:labelgover:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Label Government",defaultPath:"print-label-government.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await k(t):a===".docx"||a===".doc"?o=await N(t):o=await C(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}}),s.ipcMain.handle("report:perusahaan:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Report Perusahaan",defaultPath:"report-perusahaan.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await V(t):a===".docx"||a===".doc"?o=await H(t):o=await L(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}}),s.ipcMain.handle("report:government:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Report Government",defaultPath:"report-government.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await q(t):a===".docx"||a===".doc"?o=await X(t):o=await I(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-perusahaan:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Report Jumlah Perusahaan",defaultPath:"report-jumlah-perusahaan.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await W(t):a===".docx"||a===".doc"?o=await z(t):o=await U(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}}),s.ipcMain.handle("report:jumlah-government:export-save",async(r,t)=>{try{const{canceled:e,filePath:n}=await s.dialog.showSaveDialog({title:"Simpan Report Jumlah Government",defaultPath:"report-jumlah-government.docx",filters:[{name:"Microsoft Word (*.docx)",extensions:["docx"]},{name:"Microsoft Word 97-2003 (*.doc)",extensions:["doc"]},{name:"Microsoft Excel (*.xlsx)",extensions:["xlsx"]},{name:"Microsoft Excel 97-2003 (*.xls)",extensions:["xls"]},{name:"PDF",extensions:["pdf"]}],properties:["createDirectory","showOverwriteConfirmation"]});if(e||!n)return{success:!1,canceled:!0};const a=c.extname(n).toLowerCase();let o;a===".xlsx"||a===".xls"?o=await F(t):a===".docx"||a===".doc"?o=await Y(t):o=await A(t);const i=a===".doc"?"application/msword":a===".xls"?"application/vnd.ms-excel":o.contentType;return await w.writeFile(n,o.buffer),{success:!0,path:n,filename:c.basename(n),contentType:i}}catch(e){return p(e)}})}const M=c.dirname(Z.fileURLToPath(typeof document>"u"?require("url").pathToFileURL(__filename).href:P&&P.tagName.toUpperCase()==="SCRIPT"&&P.src||new URL("main/index.cjs",document.baseURI).href));function Ce(){const r=c.resolve(M,"..");if(c.basename(r)==="dist-electron")return c.resolve(r,"..");const t=c.resolve(M,"..","..");return c.basename(t)==="electron"?c.resolve(t,".."):c.resolve(r)}const v=Ce();process.env.APP_ROOT=v;const _=process.env.VITE_DEV_SERVER_URL,b=c.join(v,"dist-electron"),j=c.join(v,"dist");process.env.VITE_PUBLIC=_?c.join(v,"public"):j;const De=[c.join(b,"preload/index.js"),c.join(b,"preload/index.cjs"),c.join(b,"preload.js"),c.join(b,"preload.mjs"),c.join(M,"..","preload.mjs")],ke=De.find(r=>T.existsSync(r))??c.join(b,"preload/index.js"),Je={devServerUrl:_,rendererDist:j,preload:ke,publicDir:process.env.VITE_PUBLIC??c.join(v,"public")};let O=null;function Q(){return O=ee(Je),O}s.app.whenReady().then(()=>{s.Menu.setApplicationMenu(null),Se(),Te(),Re(),Ge(),Q()});s.app.on("activate",()=>{s.BrowserWindow.getAllWindows().length===0&&Q()});s.app.on("window-all-closed",()=>{process.platform!=="darwin"&&(s.app.quit(),O=null)});exports.MAIN_DIST=b;exports.RENDERER_DIST=j;exports.VITE_DEV_SERVER_URL=_;
